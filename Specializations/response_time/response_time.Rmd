---
title: "Response Time"
output: html_notebook
---


# DIFFUSION w varying drift
```{r}

#diffusion model 
nreps <- 1000
nsamples <- 5000

drift <- 0.15
s <- 0.1
a <- 0.1
non_decision <- 200
dt <- 0.001
switch <- 500
new.drift <- -0.15

latencies <- rep(0,nreps) 
responses <- rep(0,nreps)
evidence <- matrix(0, nreps, nsamples+1) # +1 to account for the starting value

for (i in c(1:nreps)) { 
  # Trial updating
  # Starting Point
  t0 = t0 + t0_var
  
  # Drifts
  drift[1] = drift * vlaue[1] + drift_var
  drift[2] = drift * value[2] + 
    
  evidence[i,] <- cumsum(c(0,
                           rnorm(switch,drift*dt,sqrt(dt)*s),
                           rnorm(nsamples-switch,new.drift*dt,sqrt(dt)*s)))
  
  p <-  which(abs(evidence[i,])>a)[1]
  responses[i] <- sign(evidence[i,p])
  latencies[i]  <- p
}
latencies <- latencies + non_decision

layout(m=array(1:2,dim=c(1,2)))
hist(latencies[responses==1])
hist(latencies[responses==-1])


```

```{r}
# playing with rnorm
a = c(0, 10, 100)
rnorm(rnorm(a, mean=a, sd=1))
```



# CDF of data
# Violin plot

[.005,.1], .3, .5, .7, .9, ]